 
UPDATE_QUERY = """ 
            UPDATE rica_payload_builders
                     SET ricaLastRunDate = TO_DATE('{ricaLastRunDate}','yyyy-mm-dd'),  
                     ricaLastRunTime = TO_TIMESTAMP('{ricaLastRunTime}','HH24:MI:SS')
                     -- ricaNextRunDate = TO_DATE('{ricaNextRunDate}','yyyy-mm-dd'),  
                     -- ricaNextRunTime = TO_TIMESTAMP('{ricaNextRunTime}','HH24:MI:SS')
                    WHERE ricaPayloadId = '{ricaPayloadId}'
         
     """
 
UPDATE_QUERY_NEXTRUNDATE = """ 
            UPDATE rica_payload_builders
                     SET ricaNextRunDate = TO_DATE('{ricaNextRunDate}','yyyy-mm-dd'),  
                     ricaNextRunTime = TO_TIMESTAMP('{ricaNextRunTime}','HH24:MI:SS')
                    WHERE ricaPayloadId = '{ricaPayloadId}'
         
     """

UPDATE_ALERTSCONCAT = """

   INSERT INTO rica_alertsconcat (    
            ricaConcatId,
           ricaAlertId,
           ricaScenarioId,
           ricaTransRef,
           ricaCustomerNo,
           ricaAccountNo,
           ricaBranchId,
           ricaDisposition,
           ricaRiskAssessment, 
           ricaAmountInvolved, 
           ricaAvertedAmount, 
           ricaRecoverAmount, 
           ricaNetLossAmount, 
           ricaAlertDate, 
           ricaAlertTime
                )       

            VALUES (
            '{journalId}',
            '{exceptionId}',
            '{ricaScenarioId}',
            '{ricaEntityId}',
            '{ricaCustomerNo}',
            '{ricaAccountNo}',
            '{branchId}',
            '{ricaNewDisposition}',
            '{ricaRiskAssessment}',
            {ricaAmount},
            {ricaAvertedAmount},
            {ricaRecoverAmount},
            {ricaNetLossAmount},
            TO_DATE('{ricaCreateDate}','yyyy-mm-dd'),
            TO_TIMESTAMP('{ricaCreateTime}','HH24:MI:SS')
             )

            """
UPDATE_ALERTQUERY = """
      INSERT INTO rica_alerts (    
            ricaAlertId,
               ricaBatchId,
               ricaTypeId,
               ricaSubTypeId,
               ricaScenarioId,
               ricaScenario,
               ricaEntityId,
               ricaEntityName,
               ricaHighlights,
               ricaAlertStatus,
               ricaFlowType,                      
               ricaAssignee,
               ricaAssignor,
               ricaRiskAssessment,
               ricaSuggestedRisk,
               ricaPriority,
               ricaBranchId,
               ricaBranchName,
               ricaCluster,
               ricaZone,
               ricaRegion,                   
               ricaRespondent,
               ricaRespondentDesignate,
               ricaInvestigator,
               ricaInvestigatorDesignate,
               ricaOwner,
               ricaOwnerDesignate,
               ricaNextOwner,
               ricaNextOwnerDesignate,
               ricaEnforcer,                    
               ricaEnforcerDesignate,                    
               ricaLikelihood,
               ricaConsequence,
               ricaCreatedBy,
               ricaCreateDate,
               ricaCreateTime,
               ricaDueDate,
               ricaLastActivity,
               ricaLastActivist,
               ricaLastActivityDate,
               radporLastActivityTime,                    
               ricaCustomerNo,
               ricaAccountNo,
               ricaAccountName,
               ricaTransId,                      
               ricaStandardComment,
               ricaAlertComment,                    
               ricaRecoveryDate,
               ricaCurrency,
               ricaAmount,
               ricaTotalAmountInvolved,
               ricaAvertedAmount,
               ricaRecoverAmount,
               ricaNetLossAmount,
               ricaRecoveryComment,
               ricaLastRunDate,
               ricaLastRunTime,
               ricaNextRunDate,                      
               ricaNextRunTime,
               ricaOldRespondent,
               ricaNewRespondent,
               ricaOldInvestigator,
               ricaNewInvestigator,
               ricaOldOwner,
               ricaNewOwner,
               ricaOldNextOwner,
               ricaNewNextOwner,
               ricaNewAssignee,
               ricaNoAttachment,
               ricaRiskScoring,
               ricaReturnStatus,
               ricaReturnTo,
               ricaValidateOverride,
               ricaAutoCaseCreate,
               ricaRegReportFlag,
               ricaReportWithinDate,
               ricaReportWithinTime,
               ricaRegReportDate,
               ricaRegReportTime,
               ricaRegReportStatus,                      
               ricaNotifyBeforeDue,
               ricaRespondentOverdueTime,
               ricaInvestigatorOverdueTime,
               ricaOwnerOverdueTime,
               ricaRespondentOverdueRepeat,
               ricaInvestigatorOverdueRepeat,
               ricaOwnerOverdueRepeat, 
               ricaOverdueRiskMatrix,
               ricaOverduePriority,
               ricaExpectedRemindTime,
               ricaRemindCounter,
               ricaRemindNextDate,
               ricaRemindNextTime,
               ricaOverdueCounter,
               ricaAutoClose,
               ricaAutoStatus,
               ricaCloseAfter,
               ricaCloseRisk  ,
               ricaNewAlertStatus ,
               ricaStatusReason,
               ricaNewAssigneeRole  ,
               ricaNewAssigneeName,
               ricaReassignRole,
               ricaReassignCriteria,
               ricaReassignee,
               ricaFindings,
               ricaActions,
               ricaGeneralComment,
               ricaDecision,
               ricaNewDisposition,
               ricaDecisionReason,
               ricaFinalRiskMatrix,
               ricaFinalLikelihood,
               ricaFinalConsequence,
               ricaFinalPriority,
               ricaOverrideDate,
               ricaOverrideTime,
               ricaTransDate,
               ricaTransTime,
               ricaDueTime,
               ricaInputter,
                ricaAuthoriser,
                ricaAccountOfficer,
                ricaVerifier
            )         

                VALUES (
                '{exceptionId}',
                '{ricaBatchId}',
                '{ricaTypeId}',
                '{ricaSubTypeId}',
                '{ricaScenarioId}',
                '{ricaScenario}',
                '{ricaEntityId}',
                '{ricaEntityName}',
                '{ricaHighlights}',
                '{ricaAlertStatus}',
                '{ricaFlowType}',
                '{ricaAssignee}',
                '{ricaAssignor}',
                '{ricaRiskAssessment}',
                '{ricaSuggestedRisk}',
                {ricaPriority},
                '{ricaBranchId}',
                '{branch_name}',
                '{ricaCluster}',
                '{ricaZone}',
                '{ricaRegion}',                  
                '{ricaRespondent}',
                '{ricaRespondentDesignate}',
                '{ricaInvestigator}',
                '{ricaInvestigatorDesignate}',
                '{ricaOwner}',
                '{ricaOwnerDesignate}',
                '{ricaNextOwner}',
                '{ricaNextOwnerDesignate}',
                '{ricaEnforcer}',                   
                '{ricaEnforcerDesignate}',                   
                '{ricaLikelihood}',
                '{ricaConsequence}',
                '{ricaCreatedBy}',
                TO_DATE('{ricaCreateDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaCreateTime}','HH24:MI:SS'),
                TO_DATE('{ricaDueDate}','yyyy-mm-dd'),
                '{ricaLastActivity}',
                '{ricaLastActivist}',
                TO_DATE('{ricaLastActivityDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{radporLastActivityTime}','HH24:MI:SS'),
                '{ricaCustomerNo}',
                '{ricaAccountNo}',
                '{ricaAccountName}',
                '{ricaTransId}',                     
                '{ricaStandardComment}',
                '{ricaAlertComment}',                   
                TO_DATE('{ricaRecoveryDate}','yyyy-mm-dd'),
                '{ricaCurrency}',
                {ricaAmount},
                {ricaTotalAmountInvolved},
                {ricaAvertedAmount},
                {ricaRecoverAmount},
                {ricaNetLossAmount},
                '{ricaRecoveryComment}',
                TO_DATE('{ricaLastRunDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaLastRunTime}','HH24:MI:SS'),
                TO_DATE('{ricaNextRunDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaNextRunTime}','HH24:MI:SS'),
                '{ricaOldRespondent}',
                '{ricaNewRespondent}',
                '{ricaOldInvestigator}',
                '{ricaNewInvestigator}',
                '{ricaOldOwner}',
                '{ricaNewOwner}',
                '{ricaOldNextOwner}',
                '{ricaNewNextOwner}',
                '{ricaNewAssignee}',
                {ricaNoAttachment},
                '{ricaRiskScoring}',
                '{ricaReturnStatus}',
                '{ricaReturnTo}',
                '{ricaValidateOverride}',
                '{ricaAutoCaseCreate}',
                '{ricaRegReportFlag}',
                TO_DATE('{ricaReportWithinDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaReportWithinTime}','HH24:MI:SS'),
                TO_DATE('{ricaRegReportDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaRegReportTime}','HH24:MI:SS'),
                '{ricaRegReportStatus}',                     
                {ricaNotifyBeforeDue}, 
                {ricaRespondentOverdueTime},
                {ricaInvestigatorOverdueTime},
                {ricaOwnerOverdueTime},
                {ricaRespondentOverdueRepeat},
                {ricaInvestigatorOverdueRepeat},
                {ricaOwnerOverdueRepeat},
                '{ricaOverdueRiskMatrix}',
                {ricaOverduePriority},
                TO_TIMESTAMP('{ricaExpectedRemindTime}','HH24:MI:SS'),
                {ricaRemindCounter},
                TO_DATE('{ricaRemindNextDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaRemindNextTime}','HH24:MI:SS'),
                {ricaOverdueCounter},
                '{ricaAutoClose}',
                '{ricaAutoStatus}',
                '{ricaCloseAfter}',
                '{ricaCloseRisk}',
                '{ricaNewAlertStatus}',
                '{ricaStatusReason}',
                '{ricaNewAssigneeRole}',
                '{ricaNewAssigneeName}',
                '{ricaReassignRole}',
                '{ricaReassignCriteria}',
                '{ricaReassignee}',
                '{ricaFindings}',
                '{ricaActions}',
                '{ricaGeneralComment}',
                '{ricaDecision}',
                '{ricaNewDisposition}',
                '{ricaDecisionReason}',
                '{ricaFinalRiskMatrix}',
                '{ricaFinalLikelihood}',
                '{ricaFinalConsequence}',
                {ricaFinalPriority},
                TO_DATE('{ricaOverrideDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaOverrideTime}','HH24:MI:SS'),
                TO_DATE('{ricaTransDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaTransTime}','HH24:MI:SS'),
                TO_TIMESTAMP('{ricaDueTime}','HH24:MI:SS'),
                '{ricaInputter}',
                '{ricaAuthoriser}',
                '{ricaAccountOfficer}',
                '{ricaVerifier}'
        )
"""

UPDATE_ALERTQUERY_DUPLICATE = """
      INSERT INTO rica_alerts_duplicate (    
            ricaDuplicateId,
            ricaAlertId,
               ricaBatchId,
               ricaTypeId,
               ricaSubTypeId,
               ricaScenarioId,
               ricaScenario,
               ricaEntityId,
               ricaEntityName,
               ricaHighlights,
               ricaAlertStatus,
               ricaFlowType,                      
               ricaAssignee,
               ricaAssignor,
               ricaRiskAssessment,
               ricaSuggestedRisk,
               ricaPriority,
               ricaBranchId,
               ricaBranchName,
               ricaCluster,
               ricaZone,
               ricaRegion,                   
               ricaRespondent,
               ricaRespondentDesignate,
               ricaInvestigator,
               ricaInvestigatorDesignate,
               ricaOwner,
               ricaOwnerDesignate,
               ricaNextOwner,
               ricaNextOwnerDesignate,
               ricaEnforcer,                    
               ricaEnforcerDesignate,                    
               ricaLikelihood,
               ricaConsequence,
               ricaCreatedBy,
               ricaCreateDate,
               ricaCreateTime,
               ricaDueDate,
               ricaLastActivity,
               ricaLastActivist,
               ricaLastActivityDate,
               radporLastActivityTime,                    
               ricaCustomerNo,
               ricaAccountNo,
               ricaAccountName,
               ricaTransId,                      
               ricaStandardComment,
               ricaAlertComment,                    
               ricaRecoveryDate,
               ricaCurrency,
               ricaAmount,
               ricaTotalAmountInvolved,
               ricaAvertedAmount,
               ricaRecoverAmount,
               ricaNetLossAmount,
               ricaRecoveryComment,
               ricaLastRunDate,
               ricaLastRunTime,
               ricaNextRunDate,                      
               ricaNextRunTime,
               ricaOldRespondent,
               ricaNewRespondent,
               ricaOldInvestigator,
               ricaNewInvestigator,
               ricaOldOwner,
               ricaNewOwner,
               ricaOldNextOwner,
               ricaNewNextOwner,
               ricaNewAssignee,
               ricaNoAttachment,
               ricaRiskScoring,
               ricaReturnStatus,
               ricaReturnTo,
               ricaValidateOverride,
               ricaAutoCaseCreate,
               ricaRegReportFlag,
               ricaReportWithinDate,
               ricaReportWithinTime,
               ricaRegReportDate,
               ricaRegReportTime,
               ricaRegReportStatus,                      
               ricaNotifyBeforeDue,
               ricaRespondentOverdueTime,
               ricaInvestigatorOverdueTime,
               ricaOwnerOverdueTime,
               ricaRespondentOverdueRepeat,
               ricaInvestigatorOverdueRepeat,
               ricaOwnerOverdueRepeat, 
               ricaOverdueRiskMatrix,
               ricaOverduePriority,
               ricaExpectedRemindTime,
               ricaRemindCounter,
               ricaRemindNextDate,
               ricaRemindNextTime,
               ricaOverdueCounter,
               ricaAutoClose,
               ricaAutoStatus,
               ricaCloseAfter,
               ricaCloseRisk  ,
               ricaNewAlertStatus ,
               ricaStatusReason,
               ricaNewAssigneeRole  ,
               ricaNewAssigneeName,
               ricaReassignRole,
               ricaReassignCriteria,
               ricaReassignee,
               ricaFindings,
               ricaActions,
               ricaGeneralComment,
               ricaDecision,
               ricaNewDisposition,
               ricaDecisionReason,
               ricaFinalRiskMatrix,
               ricaFinalLikelihood,
               ricaFinalConsequence,
               ricaFinalPriority,
               ricaOverrideDate,
               ricaOverrideTime,
               ricaTransDate,
               ricaTransTime,
               ricaDueTime,
               ricaInputter,
                ricaAuthoriser,
                ricaAccountOfficer,
                ricaVerifier
            )         

                VALUES (
                '{ricaDuplicateId}',
                '{exceptionId}',
                '{ricaBatchId}',
                '{ricaTypeId}',
                '{ricaSubTypeId}',
                '{ricaScenarioId}',
                '{ricaScenario}',
                '{ricaEntityId}',
                '{ricaEntityName}',
                '{ricaHighlights}',
                '{ricaAlertStatus}',
                '{ricaFlowType}',
                '{ricaAssignee}',
                '{ricaAssignor}',
                '{ricaRiskAssessment}',
                '{ricaSuggestedRisk}',
                {ricaPriority},
                '{ricaBranchId}',
                '{branch_name}',
                '{ricaCluster}',
                '{ricaZone}',
                '{ricaRegion}',                  
                '{ricaRespondent}',
                '{ricaRespondentDesignate}',
                '{ricaInvestigator}',
                '{ricaInvestigatorDesignate}',
                '{ricaOwner}',
                '{ricaOwnerDesignate}',
                '{ricaNextOwner}',
                '{ricaNextOwnerDesignate}',
                '{ricaEnforcer}',                   
                '{ricaEnforcerDesignate}',                   
                '{ricaLikelihood}',
                '{ricaConsequence}',
                '{ricaCreatedBy}',
                TO_DATE('{ricaCreateDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaCreateTime}','HH24:MI:SS'),
                TO_DATE('{ricaDueDate}','yyyy-mm-dd'),
                '{ricaLastActivity}',
                '{ricaLastActivist}',
                TO_DATE('{ricaLastActivityDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{radporLastActivityTime}','HH24:MI:SS'),
                '{ricaCustomerNo}',
                '{ricaAccountNo}',
                '{ricaAccountName}',
                '{ricaTransId}',                     
                '{ricaStandardComment}',
                '{ricaAlertComment}',                   
                TO_DATE('{ricaRecoveryDate}','yyyy-mm-dd'),
                '{ricaCurrency}',
                {ricaAmount},
                {ricaTotalAmountInvolved},
                {ricaAvertedAmount},
                {ricaRecoverAmount},
                {ricaNetLossAmount},
                '{ricaRecoveryComment}',
                TO_DATE('{ricaLastRunDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaLastRunTime}','HH24:MI:SS'),
                TO_DATE('{ricaNextRunDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaNextRunTime}','HH24:MI:SS'),
                '{ricaOldRespondent}',
                '{ricaNewRespondent}',
                '{ricaOldInvestigator}',
                '{ricaNewInvestigator}',
                '{ricaOldOwner}',
                '{ricaNewOwner}',
                '{ricaOldNextOwner}',
                '{ricaNewNextOwner}',
                '{ricaNewAssignee}',
                {ricaNoAttachment},
                '{ricaRiskScoring}',
                '{ricaReturnStatus}',
                '{ricaReturnTo}',
                '{ricaValidateOverride}',
                '{ricaAutoCaseCreate}',
                '{ricaRegReportFlag}',
                TO_DATE('{ricaReportWithinDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaReportWithinTime}','HH24:MI:SS'),
                TO_DATE('{ricaRegReportDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaRegReportTime}','HH24:MI:SS'),
                '{ricaRegReportStatus}',                     
                {ricaNotifyBeforeDue}, 
                {ricaRespondentOverdueTime},
                {ricaInvestigatorOverdueTime},
                {ricaOwnerOverdueTime},
                {ricaRespondentOverdueRepeat},
                {ricaInvestigatorOverdueRepeat},
                {ricaOwnerOverdueRepeat},
                '{ricaOverdueRiskMatrix}',
                {ricaOverduePriority},
                TO_TIMESTAMP('{ricaExpectedRemindTime}','HH24:MI:SS'),
                {ricaRemindCounter},
                TO_DATE('{ricaRemindNextDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaRemindNextTime}','HH24:MI:SS'),
                {ricaOverdueCounter},
                '{ricaAutoClose}',
                '{ricaAutoStatus}',
                '{ricaCloseAfter}',
                '{ricaCloseRisk}',
                '{ricaNewAlertStatus}',
                '{ricaStatusReason}',
                '{ricaNewAssigneeRole}',
                '{ricaNewAssigneeName}',
                '{ricaReassignRole}',
                '{ricaReassignCriteria}',
                '{ricaReassignee}',
                '{ricaFindings}',
                '{ricaActions}',
                '{ricaGeneralComment}',
                '{ricaDecision}',
                '{ricaNewDisposition}',
                '{ricaDecisionReason}',
                '{ricaFinalRiskMatrix}',
                '{ricaFinalLikelihood}',
                '{ricaFinalConsequence}',
                {ricaFinalPriority},
                TO_DATE('{ricaOverrideDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaOverrideTime}','HH24:MI:SS'),
                TO_DATE('{ricaTransDate}','yyyy-mm-dd'),
                TO_TIMESTAMP('{ricaTransTime}','HH24:MI:SS'),
                TO_TIMESTAMP('{ricaDueTime}','HH24:MI:SS'),
                '{ricaInputter}',
                '{ricaAuthoriser}',
                '{ricaAccountOfficer}',
                '{ricaVerifier}'
        )
"""


UPDATE_EXCEPTION_OUTPUT = """ 
         INSERT INTO ricaExceptionOutput (  
            ricaExceptionId,
            ricaScenarioId,
            ricaExceptionDescription,
            ricaBranchId,
            ricaExceptionIndicator,
             ricaRespondent,
                   ricaRespondentDesignate,
                   ricaInvestigator,
                   ricaInvestigatorDesignate,
                   ricaOwner,
                   ricaOwnerDesignate,
                   ricaNextOwner,
                   ricaNextOwnerDesignate,
                   ricaEnforcer,    
            ricaOtherReceivers,
               ricaExceptionResult,
               ricaExceptionRunTime,
               ricaExceptionRunDate

               )
               VALUES (
                '{exceptionId}',
                '{ricaScenarioId}',
                '{ricaExceptionDescription}',
                '{ricaBranchs}',
                '{ricaExceptionIndicator}',
                '{ricaRespondent}',
                    '{ricaRespondentDesignate}',
                    '{ricaInvestigator}',
                    '{ricaInvestigatorDesignate}',
                    '{ricaOwner}',
                    '{ricaOwnerDesignate}',
                    '{ricaNextOwner}',
                    '{ricaNextOwnerDesignate}',
                    '{ricaEnforcer}',              
                '{ricaOtherReceivers}',
               TO_CLOB(:exceptionResult),
            TO_TIMESTAMP('{ricaExceptionRunTime}','HH24:MI:SS'),
                TO_DATE('{ricaExceptionRunDate}','yyyy-mm-dd')

                  )
        """


GET_SPF=""" select ricaClientName,ricaStmpMailServer,ricaStmpMailPort,ricaStmpMailUser,ricaStmpMailPassword,
     ricaDefaultOwner,ricaDefaultRespondent,ricaDefaultInvestigator,ricaLicenseCode,ricaLicenseNotifyDur,
     to_char(ricaExpiryDate,'YYYY-MM-DD') AS ricaExpiryDate 
     from rica_spf 
     where ricaSpfId='{lang}-SYSTEM' """


GET_PK=""" SELECT cols.column_name 
 FROM all_constraints cons 
 JOIN all_cons_columns cols
ON cons.constraint_name = cols.constraint_name
  WHERE cons.constraint_type = 'P'
  AND cons.table_name = '{table_name}'"""